{% extends "index.html" %}

{% block content %}
<!-- åŒ¹é…åº¦åˆ†ææ ‡ç­¾é¡µ -->
<div class="tab-content active">
    <div class="card">
        <h2>ğŸ’• åŒ¹é…åº¦åˆ†æ</h2>
        <p class="subtitle">åˆ†æä¸¤ä¸ªäººåœ¨æƒ…æ„Ÿã€ç”Ÿæ´»ã€äº‹ä¸šç­‰æ–¹é¢çš„åŒ¹é…åº¦</p>
        
        {% if error %}
        <div class="error-message">{{ error }}</div>
        {% endif %}
        
        <form method="POST" action="{{ url_for('main.compatibility') }}">
            <h3 style="color: #667eea; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #e0e0e0;">ğŸ‘¤ ç¬¬ä¸€äººä¿¡æ¯</h3>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="name1">å§“åï¼š</label>
                    <input type="text" id="name1" name="name1" value="{{ request.form.get('name1', '') }}" required>
                </div>
                
                <div class="form-group">
                    <label for="birthday1">ç”Ÿæ—¥ï¼š</label>
                    <input type="date" id="birthday1" name="birthday1" value="{{ request.form.get('birthday1', '') }}" required>
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="mbti1">MBTIç±»å‹ï¼š</label>
                    <select id="mbti1" name="mbti1" required>
                        <option value="">è¯·é€‰æ‹©MBTIç±»å‹</option>
                        <option value="INTJ" {% if request.form.get('mbti1') == 'INTJ' %}selected{% endif %}>INTJ - å»ºç­‘å¸ˆ</option>
                        <option value="INTP" {% if request.form.get('mbti1') == 'INTP' %}selected{% endif %}>INTP - é€»è¾‘å­¦å®¶</option>
                        <option value="ENTJ" {% if request.form.get('mbti1') == 'ENTJ' %}selected{% endif %}>ENTJ - æŒ‡æŒ¥å®˜</option>
                        <option value="ENTP" {% if request.form.get('mbti1') == 'ENTP' %}selected{% endif %}>ENTP - è¾©è®ºå®¶</option>
                        <option value="INFJ" {% if request.form.get('mbti1') == 'INFJ' %}selected{% endif %}>INFJ - æå€¡è€…</option>
                        <option value="INFP" {% if request.form.get('mbti1') == 'INFP' %}selected{% endif %}>INFP - è°ƒåœè€…</option>
                        <option value="ENFJ" {% if request.form.get('mbti1') == 'ENFJ' %}selected{% endif %}>ENFJ - ä¸»äººå…¬</option>
                        <option value="ENFP" {% if request.form.get('mbti1') == 'ENFP' %}selected{% endif %}>ENFP - ç«é€‰è€…</option>
                        <option value="ISTJ" {% if request.form.get('mbti1') == 'ISTJ' %}selected{% endif %}>ISTJ - ç‰©æµå¸ˆ</option>
                        <option value="ISFJ" {% if request.form.get('mbti1') == 'ISFJ' %}selected{% endif %}>ISFJ - å®ˆå«è€…</option>
                        <option value="ESTJ" {% if request.form.get('mbti1') == 'ESTJ' %}selected{% endif %}>ESTJ - æ€»ç»ç†</option>
                        <option value="ESFJ" {% if request.form.get('mbti1') == 'ESFJ' %}selected{% endif %}>ESFJ - æ‰§æ”¿å®˜</option>
                        <option value="ISTP" {% if request.form.get('mbti1') == 'ISTP' %}selected{% endif %}>ISTP - é‰´èµå®¶</option>
                        <option value="ISFP" {% if request.form.get('mbti1') == 'ISFP' %}selected{% endif %}>ISFP - æ¢é™©å®¶</option>
                        <option value="ESTP" {% if request.form.get('mbti1') == 'ESTP' %}selected{% endif %}>ESTP - ä¼ä¸šå®¶</option>
                        <option value="ESFP" {% if request.form.get('mbti1') == 'ESFP' %}selected{% endif %}>ESFP - è¡¨æ¼”è€…</option>
                    </select>
                </div>
            </div>
            
            <h3 style="color: #667eea; margin: 30px 0 20px 0; padding-bottom: 10px; border-bottom: 2px solid #e0e0e0;">ğŸ‘¤ ç¬¬äºŒäººä¿¡æ¯</h3>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="name2">å§“åï¼š</label>
                    <input type="text" id="name2" name="name2" value="{{ request.form.get('name2', '') }}" required>
                </div>
                
                <div class="form-group">
                    <label for="birthday2">ç”Ÿæ—¥ï¼š</label>
                    <input type="date" id="birthday2" name="birthday2" value="{{ request.form.get('birthday2', '') }}" required>
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="mbti2">MBTIç±»å‹ï¼š</label>
                    <select id="mbti2" name="mbti2" required>
                        <option value="">è¯·é€‰æ‹©MBTIç±»å‹</option>
                        <option value="INTJ" {% if request.form.get('mbti2') == 'INTJ' %}selected{% endif %}>INTJ - å»ºç­‘å¸ˆ</option>
                        <option value="INTP" {% if request.form.get('mbti2') == 'INTP' %}selected{% endif %}>INTP - é€»è¾‘å­¦å®¶</option>
                        <option value="ENTJ" {% if request.form.get('mbti2') == 'ENTJ' %}selected{% endif %}>ENTJ - æŒ‡æŒ¥å®˜</option>
                        <option value="ENTP" {% if request.form.get('mbti2') == 'ENTP' %}selected{% endif %}>ENTP - è¾©è®ºå®¶</option>
                        <option value="INFJ" {% if request.form.get('mbti2') == 'INFJ' %}selected{% endif %}>INFJ - æå€¡è€…</option>
                        <option value="INFP" {% if request.form.get('mbti2') == 'INFP' %}selected{% endif %}>INFP - è°ƒåœè€…</option>
                        <option value="ENFJ" {% if request.form.get('mbti2') == 'ENFJ' %}selected{% endif %}>ENFJ - ä¸»äººå…¬</option>
                        <option value="ENFP" {% if request.form.get('mbti2') == 'ENFP' %}selected{% endif %}>ENFP - ç«é€‰è€…</option>
                        <option value="ISTJ" {% if request.form.get('mbti2') == 'ISTJ' %}selected{% endif %}>ISTJ - ç‰©æµå¸ˆ</option>
                        <option value="ISFJ" {% if request.form.get('mbti2') == 'ISFJ' %}selected{% endif %}>ISFJ - å®ˆå«è€…</option>
                        <option value="ESTJ" {% if request.form.get('mbti2') == 'ESTJ' %}selected{% endif %}>ESTJ - æ€»ç»ç†</option>
                        <option value="ESFJ" {% if request.form.get('mbti2') == 'ESFJ' %}selected{% endif %}>ESFJ - æ‰§æ”¿å®˜</option>
                        <option value="ISTP" {% if request.form.get('mbti2') == 'ISTP' %}selected{% endif %}>ISTP - é‰´èµå®¶</option>
                        <option value="ISFP" {% if request.form.get('mbti2') == 'ISFP' %}selected{% endif %}>ISFP - æ¢é™©å®¶</option>
                        <option value="ESTP" {% if request.form.get('mbti2') == 'ESTP' %}selected{% endif %}>ESTP - ä¼ä¸šå®¶</option>
                        <option value="ESFP" {% if request.form.get('mbti2') == 'ESFP' %}selected{% endif %}>ESFP - è¡¨æ¼”è€…</option>
                    </select>
                </div>
            </div>
            
            <div style="margin-top: 30px; text-align: center;">
                <button type="submit" class="btn-primary" style="font-size: 18px; padding: 15px 40px;">ğŸ’• å¼€å§‹åŒ¹é…åº¦åˆ†æ</button>
                <button type="reset" class="btn-secondary" style="font-size: 18px; padding: 15px 40px; margin-left: 10px;">é‡ç½®</button>
            </div>
        </form>
    </div>
    
    <!-- åˆ†æç»“æœ -->
    {% if result %}
    <div class="card">
        <h2>ğŸ“Š åŒ¹é…åº¦åˆ†æç»“æœ</h2>
        <div class="result-content">
            <h3 style="color: #667eea; margin-bottom: 15px;">{{ result.name1 }} ğŸ†š {{ result.name2 }}</h3>
            
            <div class="result-section">
                <h4 style="color: #764ba2; margin-bottom: 10px;">ğŸ’• ç»¼åˆåŒ¹é…åº¦</h4>
                <div style="font-size: 24px; font-weight: bold; color: #667eea; margin: 10px 0;">
                    {{ result.combined_result.combined_match.score }}åˆ† - {{ result.combined_result.combined_match.level }}
                </div>
            </div>
            
            <div class="two-column" style="margin-top: 20px;">
                <div class="result-section">
                    <h4 style="color: #764ba2; margin-bottom: 10px;">ğŸ’‘ æƒ…æ„ŸåŒ¹é…åº¦</h4>
                    <div style="font-size: 20px; font-weight: bold; color: #667eea;">
                        {{ result.combined_result.emotion_match.score }}åˆ†
                    </div>
                    <div>{{ result.combined_result.emotion_match.level }}</div>
                </div>
                
                <div class="result-section">
                    <h4 style="color: #764ba2; margin-bottom: 10px;">ğŸ  ç”Ÿæ´»åŒ¹é…åº¦</h4>
                    <div style="font-size: 20px; font-weight: bold; color: #667eea;">
                        {{ result.combined_result.life_match.score }}åˆ†
                    </div>
                    <div>{{ result.combined_result.life_match.level }}</div>
                </div>
            </div>
            
            <div class="result-section" style="margin-top: 20px;">
                <h4 style="color: #764ba2; margin-bottom: 10px;">ğŸ’¼ äº‹ä¸šåŒ¹é…åº¦</h4>
                <div style="font-size: 20px; font-weight: bold; color: #667eea;">
                    {{ result.combined_result.career_match.score }}åˆ†
                </div>
                <div>{{ result.combined_result.career_match.level }}</div>
            </div>
            
            <hr style="margin: 20px 0; border: 1px solid #e0e0e0;">
            
            <div class="result-section">
                <h4 style="color: #764ba2; margin-bottom: 10px;">ğŸ“ˆ è¯¦ç»†åˆ†æ</h4>
                <div>{{ result.detailed_analysis|replace('\n', '<br>')|safe }}</div>
            </div>
            
            {% if result.chart_html %}
            <div class="result-section" style="margin-top: 20px;">
                <h4 style="color: #764ba2; margin-bottom: 10px;">ğŸ“Š åŒ¹é…åº¦å›¾è¡¨</h4>
                <div>{{ result.chart_html|safe }}</div>
            </div>
            {% endif %}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}

